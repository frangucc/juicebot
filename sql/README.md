# Database Migrations

## Setup

1. Go to your Supabase project dashboard
2. Navigate to SQL Editor
3. Run the migrations in order:
   - `001_init_schema.sql` - Initial schema

## Schema Overview

### Core Tables

- **users** - User accounts with phone, preferences, capital
- **screener_alerts** - Real-time alerts generated by screener
- **trades** - Position tracking from entry to exit
- **sms_messages** - SMS conversation history
- **market_data_cache** - Recent bars and indicators (JSONB)
- **screener_performance** - System metrics

### Key Features

- JSONB columns for flexible data (bars, indicators, metadata)
- Row-level security (RLS) enabled for user data
- Indexes optimized for time-series queries
- Triggers for auto-updating timestamps
- Views for common queries

## Querying Examples

```sql
-- Get today's alerts
SELECT * FROM screener_alerts
WHERE trigger_time >= CURRENT_DATE
ORDER BY trigger_time DESC;

-- Get user's active trades
SELECT * FROM trades
WHERE user_id = 'user-uuid'
AND status IN ('entered', 'monitoring');

-- Get screener performance last hour
SELECT * FROM screener_performance
WHERE timestamp >= NOW() - INTERVAL '1 hour'
ORDER BY timestamp DESC;
```
